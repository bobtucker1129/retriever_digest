# Ralph Progress Log
Started: Tue Jan 20 23:22:04 EST 2026

## Codebase Patterns
- Next.js 14 App Router with TypeScript in `src/app` directory
- Run `npx tsc --noEmit` to typecheck
- Prisma 7 uses `prisma.config.ts` for DATABASE_URL (not in schema.prisma)
- Prisma client generated to `src/generated/prisma`
- Manually create migration files when DB unavailable: `prisma/migrations/<timestamp>_<name>/migration.sql`
- Use `IF NOT EXISTS` in migration SQL for idempotency

---

## 2026-01-20 - US-001
Thread: https://ampcode.com/threads/T-019bdec9-e13c-74a8-9e57-bf55a5064abe
- Initialized Next.js 14 project with TypeScript and App Router
- Created src/app/layout.tsx and src/app/page.tsx
- Added .env.example with placeholders for all required env vars
- Added .gitignore for node_modules, .env, .next
- Verified `npm run dev` works and typecheck passes
- **Learnings for future iterations:**
  - Create-next-app fails when directory has existing files; manually set up instead
  - Next.js 14 with App Router uses `src/app` directory structure

---

## 2026-01-21 - US-002
Thread: https://ampcode.com/threads/T-019bdecb-9c0b-76cf-94a0-8a968d67b816
- Set up Prisma with PostgreSQL connection
- Installed prisma (dev) and dotenv packages
- Created prisma/schema.prisma with PostgreSQL provider
- Created prisma.config.ts with DATABASE_URL configuration
- Prisma client generated to src/generated/prisma
- **Learnings for future iterations:**
  - Prisma 7 no longer uses `url = env("DATABASE_URL")` in schema.prisma
  - Connection URL is now configured in prisma.config.ts
  - Must install dotenv for prisma.config.ts to read env vars

---

## 2026-01-21 - US-003
Thread: https://ampcode.com/threads/T-019bdecc-e470-75d8-bf72-0749e9bed927
- Created Goal model with enum GoalType (MONTHLY, ANNUAL)
- Added fields: id, type (unique), salesRevenue (Decimal 12,2), salesCount, estimatesCreated, newCustomers, createdAt, updatedAt
- Created migration file in prisma/migrations/20260121000000_add_goal_model/
- Regenerated Prisma client with Goal model types
- **Learnings for future iterations:**
  - Prisma migrations require DB connection; use `--create-only` or manually create migration files when DB is unavailable
  - Use @unique on type field to enforce one record per GoalType (upsert pattern)
  - Use `CREATE TABLE IF NOT EXISTS` and `CREATE TYPE` for idempotent migrations

---

## 2026-01-21 - US-004
Thread: https://ampcode.com/threads/T-019bdece-2f4a-742e-b442-122adee1ceb5
- Created Recipient model with fields: id, name, email (unique), active (default true), createdAt, updatedAt
- Created migration file in prisma/migrations/20260121000001_add_recipient_model/
- Regenerated Prisma client with Recipient model types
- **Learnings for future iterations:**
  - Follow same pattern as Goal migration: use `IF NOT EXISTS` for tables and indexes

---

## 2026-01-21 - US-005
Thread: https://ampcode.com/threads/T-019bdecf-329f-777e-8669-814c097a9078
- Created DigestData model with fields: id, exportDate (DateTime unique), data (Json), createdAt
- Created migration file in prisma/migrations/20260121000002_add_digest_data_model/
- Used JSONB type for PostgreSQL JSON data storage
- Regenerated Prisma client with DigestData model types
- **Learnings for future iterations:**
  - Use JSONB (not JSON) in PostgreSQL for better indexing/querying support

---
